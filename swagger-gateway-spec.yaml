openapi: 3.0.0
paths:
  /:
    get:
      operationId: AppController_haldleHello
      parameters: []
      responses:
        '200':
          description: ''
      tags:
        - Root
  /contexts/trusted-list/v1:
    get:
      operationId: ContextController_handleContextLoader
      parameters: []
      responses:
        '200':
          description: ''
      tags:
        - Context
  /manager/status-lists/register:
    post:
      operationId: PrivateAnalyzerController_handleAddStatusList
      parameters:
        - name: X-Correlation-ID
          in: header
          description: 処理識別子
          required: false
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StatusListCreateDto'
      responses:
        '201':
          description: Status listの登録が正常終了した
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AddResponse'
        '400':
          description: リクエストが無効
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: 認証エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 認証は成功したが、この操作を実行する権限がない
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: データが存在しない
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: VCデータの検証に失敗した
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: サーバー内部エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      security: &ref_0
        - jwt: []
      tags: &ref_1
        - manager
  /manager/status-lists/{listId}/entries/{index}/status:
    put:
      operationId: PrivateAnalyzerController_handleUpdateStatusListStatus
      parameters:
        - name: listId
          required: true
          in: path
          description: Status list lisの識別子
          schema:
            type: string
        - name: index
          required: true
          in: path
          description: Status listの状態が設定されている位置情報
          schema:
            example: 20
            type: number
        - name: X-Correlation-ID
          in: header
          description: 処理識別子
          required: false
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/StatusListUpdateDto'
      responses:
        '200':
          description: Status listの状態更新が正常終了した
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetOrPutResponse'
        '400':
          description: リクエストが無効
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: 認証エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 認証は成功したが、この操作を実行する権限がない
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: データが存在しない
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: データの検証に失敗した
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: サーバー内部エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      security: *ref_0
      tags: *ref_1
  /manager/trusted-issuers:
    post:
      operationId: PrivateAnalyzerController_handleAddTrustedIssuer
      parameters:
        - name: X-Correlation-ID
          in: header
          description: 処理識別子
          required: false
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubjectDidRegistrationDto'
      responses:
        '201':
          description: Trusted listの登録が正常終了した
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AddOrPutResponse'
        '400':
          description: リクエストが無効
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: 認証エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 認証は成功したが、この操作を実行する権限がない
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: データが存在しない
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: データの検証に失敗した
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: サーバー内部エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      security: *ref_0
      tags: *ref_1
    delete:
      operationId: PrivateAnalyzerController_handleDeleteTrustedIssuer
      parameters:
        - name: subjectDid
          required: true
          in: path
          description: 処理依頼者のDIDを設定する
          schema: {}
        - name: X-Correlation-ID
          in: header
          description: 処理識別子
          required: false
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubjectDidDeleteDto'
      responses:
        '200':
          description: Trusted listの削除が正常終了した
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DeleteResponse'
        '400':
          description: リクエストが無効
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: 認証エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 認証は成功したが、この操作を実行する権限がない
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: データが存在しない
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: データの検証に失敗した
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: サーバー内部エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      security: *ref_0
      tags: *ref_1
  /manager/trusted-issuers/{subjectDid}:
    put:
      operationId: PrivateAnalyzerController_handleUpdateTrustedIssuer
      parameters:
        - name: subjectDid
          required: true
          in: path
          description: 処理依頼者のDIDを設定する
          schema:
            type: string
        - name: X-Correlation-ID
          in: header
          description: 処理識別子
          required: false
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubjectDidUpdateDto'
      responses:
        '200':
          description: Trusted listの更新が正常終了した
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AddOrPutResponse'
        '400':
          description: リクエストが無効
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: 認証エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: 認証は成功したが、この操作を実行する権限がない
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: データが存在しない
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: データの検証に失敗した
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: サーバー内部エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      security: *ref_0
      tags: *ref_1
  /verifiers/resolve/{did}:
    get:
      description: このエンドポイントはDIDを解決します。入力としてDIDを受け取ります。
      operationId: PublicAnalyzerController_hundleGetDidDocument
      parameters:
        - name: Accept
          required: false
          in: header
          description: 処理識別子
          examples:
            application/did+json:
              value: applicaiton/json
              description: DIDドキュメントのメディアタイプ（JSON）
            application/did+ld+json:
              value: applicaiton/did+ld+json
              description: DIDドキュメントのメディアタイプ（JSON-LD）。
            application/ld+json;profile="https://w3id.org/did-resolution":
              value: application/ld+json;profile="https://w3id.org/did-resolution"
              description: DID解決結果のメディアタイプ (JSON-LD).
          schema:
            type: string
        - name: did
          required: true
          in: path
          description: 解決するDIDを指定する
          schema:
            example: did:key:z6MknCCLeeHBUaHu4aHSVLDCYQW9gjVJ7a63FpMvtuVMy53T
            type: string
        - name: X-Correlation-ID
          in: header
          description: 処理識別子
          required: false
          schema:
            type: string
      responses:
        '200':
          content:
            application/did+json:
              schema:
                type: object
                description: The DID document (JSON representation).
                example:
                  id: did:indy:sovrin:WRfXPg8dantKVubE3HX8pw
                  verificationMethod:
                    - id: did:indy:sovrin:WRfXPg8dantKVubE3HX8pw#key-1
                      type: Ed25519VerificationKey2018
                      publicKeyBase58: H3C2AVvLMv6gmMNam3uVAjZpfkcJCwDwnZn6z3wXmqPV
            application/did+ld+json:
              schema:
                type: object
                description: The DID document (JSON-LD representation).
                example:
                  '@context': https://www.w3.org/ns/did/v1
                  id: did:indy:sovrin:WRfXPg8dantKVubE3HX8pw
                  verificationMethod:
                    - id: did:indy:sovrin:WRfXPg8dantKVubE3HX8pw#key-1
                      type: Ed25519VerificationKey2018
                      publicKeyBase58: H3C2AVvLMv6gmMNam3uVAjZpfkcJCwDwnZn6z3wXmqPV
            application/ld+json;profile="https://w3id.org/did-resolution":
              schema:
                description: The DID resolution result.
                type: object
                properties:
                  didDocument:
                    type: object
                  didResolutionMetadata:
                    type: object
                    additionalProperties: {}
                  didDocumentMetadata:
                    type: object
                    additionalProperties: {}
          description: DIDの解決に成功した
        '400':
          description: リクエストが無効
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: データが存在しない
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '406':
          description: サポートされていない表現です。
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '410':
          description: 正常に解決されましたが、DIDは無効化されています。
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: サーバー内部エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '501':
          description: DIDメソッドはサポートされていません
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      summary: Resolver DID
      tags: &ref_2
        - verifiers
  /verifiers/status-checks/{listId}/{index}:
    get:
      operationId: PublicAnalyzerController_hundleGetStatus
      parameters:
        - name: X-Correlation-ID
          required: false
          in: header
          description: 処理識別子
          schema:
            type: string
        - name: listId
          required: true
          in: path
          description: Status list lisの識別子
          schema:
            type: string
        - name: index
          required: true
          in: path
          description: Status listの状態が設定されている位置情報
          schema:
            type: number
      responses:
        '200':
          description: Status listの状態取得が正常に終了した
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetOrPutResponse'
        '400':
          description: リクエストが無効
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: データが存在しない
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: データの検証に失敗した
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: サーバー内部エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      summary: Status listの状態を取得する
      tags: *ref_2
  /verifiers/trusted-issuers/{did}:
    get:
      operationId: PublicAnalyzerController_handleTrustedIssuer
      parameters:
        - name: X-Correlation-ID
          required: false
          in: header
          description: 処理識別子
          schema:
            type: string
        - name: did
          required: true
          in: path
          description: 発行者のDID
          schema:
            type: string
      responses:
        '200':
          description: Status listの状態取得が正常に終了した
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetResponse'
        '400':
          description: リクエストが無効
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: データが存在しない
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: データの検証に失敗した
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: サーバー内部エラー
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
      summary: Trusted listの状態を取得する
      tags: *ref_2
info:
  title: VC Analyzer System GateWay API
  description: API documentation for the VC Analyzer System management plane.
  version: '1.0'
  contact: {}
tags: []
servers: []
components:
  schemas:
    StatusListCreateDto:
      type: object
      properties:
        credentials:
          type: number
          example: '1000'
      required:
        - credentials
    AddStatusIssuer:
      type: object
      properties:
        listId:
          type: string
          description: リストID
          example: urn:d8290d62-813d-44a9-98d3-fd27c85f729b
      required:
        - listId
    AddPayloadLoad:
      type: object
      properties:
        statusIssuer:
          description: 発行者のステータスリスト情報
          allOf:
            - $ref: '#/components/schemas/AddStatusIssuer'
        status:
          type: string
          description: 状態コード
          examples:
            - value: revoked
              description: 失効
            - value: valid
              description: 正常
      required:
        - statusIssuer
        - status
    ServiceMetadata:
      type: object
      properties:
        serviceName:
          type: string
          description: サービス名
        version:
          type: string
          description: サービスバージョン
        timestamp:
          type: string
          description: 応答時間
        processingTimeMillis:
          type: string
          description: 処理時間
        ipfsGatewayUrl:
          type: string
          description: IPFS URL
        fetchedCid:
          type: string
          description: IPFS CID
      required:
        - serviceName
        - version
        - timestamp
        - processingTimeMillis
        - ipfsGatewayUrl
        - fetchedCid
    AddResponse:
      type: object
      properties:
        payload:
          description: ペイロード
          allOf:
            - $ref: '#/components/schemas/AddPayloadLoad'
        serviceMetadata:
          description: サービスメタ情報
          allOf:
            - $ref: '#/components/schemas/ServiceMetadata'
      required:
        - payload
    ServiceError:
      type: object
      properties:
        error:
          type: object
          description: エラーメッセージ
        serviceMetaData:
          type: object
          description: サービスメタ情報
      required:
        - error
        - serviceMetaData
    ErrorServiceMetadata:
      type: object
      properties:
        serviceName:
          type: string
          description: サービス名
        version:
          type: string
          description: バージョン情報
        timestamp:
          type: string
          description: 応答時間
        processingTimeMillis:
          type: string
          description: 処理時間
        correlationId:
          type: string
          description: 処理識別子
      required:
        - serviceName
        - version
        - processingTimeMillis
        - correlationId
    ExternalServiceErrorResponse:
      type: object
      properties:
        message:
          type: string
          description: エラーメッセージ
        code:
          type: string
          description: エラーコード
        serviceError:
          description: 外部連携エラー情報
          allOf:
            - $ref: '#/components/schemas/ServiceError'
        serviceMetaData:
          description: サービスメタ情報
          allOf:
            - $ref: '#/components/schemas/ErrorServiceMetadata'
      required:
        - message
        - code
        - serviceError
        - serviceMetaData
    ErrorDetail:
      type: object
      properties:
        message:
          type: string
          description: エラーメッセージ
        code:
          type: string
          description: エラーコード
        externalServiceError:
          description: サービス連携エラー情報
          allOf:
            - $ref: '#/components/schemas/ExternalServiceErrorResponse'
        details:
          description: エラー詳細
          type: array
          items:
            type: object
      required:
        - message
        - code
        - externalServiceError
        - details
    ErrorResponse:
      type: object
      properties:
        error:
          description: エラーメッセージ
          allOf:
            - $ref: '#/components/schemas/ErrorDetail'
        serviceMetaData:
          description: サービスメタ情報
          allOf:
            - $ref: '#/components/schemas/ErrorServiceMetadata'
      required:
        - error
        - serviceMetaData
    StatusListUpdateDto:
      type: object
      properties:
        status:
          type: string
          example: revoked
      required:
        - status
    GetOrPutStatusIssuer:
      type: object
      properties:
        listId:
          type: string
          description: リストID
          example: urn:d8290d62-813d-44a9-98d3-fd27c85f729b
        index:
          type: string
          description: インデックス
          example: '123'
      required:
        - listId
        - index
    GetOrPutPayloadLoad:
      type: object
      properties:
        statusIssuer:
          description: 発行者のステータスリスト情報
          allOf:
            - $ref: '#/components/schemas/GetOrPutStatusIssuer'
        status:
          type: string
          description: 状態コード
          examples:
            - value: revoked
              description: 失効
            - value: valid
              description: 正常
      required:
        - statusIssuer
        - status
    GetOrPutResponse:
      type: object
      properties:
        payload:
          description: ペイロード
          allOf:
            - $ref: '#/components/schemas/GetOrPutPayloadLoad'
        serviceMetadata:
          description: サービスメタ情報
          allOf:
            - $ref: '#/components/schemas/ServiceMetadata'
      required:
        - payload
    SubjectDidRegistrationDto:
      type: object
      properties:
        subjectDid:
          type: string
          example: did:key:z6Mkiq1TQyWPezBTGoqNvcq9b6azWMyn6HwQmbjo5LLpai68
        policy:
          type: object
      required:
        - subjectDid
    AddOrPutTrustedIssuer:
      type: object
      properties:
        trustedIssuer:
          type: string
          description: 発行者のDID
          example: did:key:z6Mkiq1TQyWPezBTGoqNvcq9b6azWMyn6HwQmbjo5LLpai68
      required:
        - trustedIssuer
    AddOrPutResponse:
      type: object
      properties:
        payload:
          description: ペイロード
          allOf:
            - $ref: '#/components/schemas/AddOrPutTrustedIssuer'
        serviceMetadata:
          description: サービスメタ情報
          allOf:
            - $ref: '#/components/schemas/ServiceMetadata'
      required:
        - payload
    SubjectDidUpdateDto:
      type: object
      properties:
        validUntil:
          type: string
        policy:
          type: object
    SubjectDidDeleteDto:
      type: object
      properties:
        subjectDid:
          type: string
          example: did:key:z6Mkiq1TQyWPezBTGoqNvcq9b6azWMyn6HwQmbjo5LLpai68
      required:
        - subjectDid
    DeleteServiceMetadata:
      type: object
      properties:
        serviceName:
          type: string
          description: サービス名
        version:
          type: string
          description: サービスバージョン
        timestamp:
          type: string
          description: 応答時間
        processingTimeMillis:
          type: string
          description: 処理時間
      required:
        - serviceName
        - version
        - timestamp
        - processingTimeMillis
    DeleteResponse:
      type: object
      properties:
        payload:
          description: ペイロード
          allOf:
            - $ref: '#/components/schemas/AddOrPutTrustedIssuer'
        serviceMetadata:
          description: サービスメタ情報
          allOf:
            - $ref: '#/components/schemas/DeleteServiceMetadata'
      required:
        - payload
    GetTrustedIssuer:
      type: object
      properties:
        trustedIssuer:
          type: string
          description: 発行者のDID
          example: did:key:z6Mkiq1TQyWPezBTGoqNvcq9b6azWMyn6HwQmbjo5LLpai68
        status:
          type: string
          description: 状態コード
          examples:
            - value: no-trusted
              description: 信頼されていない
            - value: trusted
              description: 信頼されている
        validUntil:
          type: string
          description: 有効期限
          example: '2025-05-10T12:01:04.828Z'
      required:
        - trustedIssuer
        - status
        - validUntil
    GetResponse:
      type: object
      properties:
        payload:
          description: ペイロード
          allOf:
            - $ref: '#/components/schemas/GetTrustedIssuer'
        serviceMetadata:
          description: サービスメタ情報
          allOf:
            - $ref: '#/components/schemas/ServiceMetadata'
      required:
        - payload
