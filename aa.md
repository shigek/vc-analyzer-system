# Account Abstraction (AA) が登場した背景

Account Abstractionが登場した背景には、主に以下の2つの主要な課題と、それらを解決したいという強いニーズがありました。

1. 既存のEOA（Externally Owned Account）が抱える根源的な課題
2. Web3のユーザー体験（UX）の悪さ

## 1. 既存のEOAが抱える根源的な課題

Ethereumをはじめとするほとんどのブロックチェーンで採用されているEOA（外部所有アカウント）は、設計がシンプルであるがゆえに、いくつかの深刻な問題を抱えていました。

- 秘密鍵の単一障害点:
  - EOAは、単一の秘密鍵によって完全に制御されます。 この秘密鍵を紛失すると、アカウント内の資産は永遠に失われます。これは「自己管理」の最大の障壁であり、ユーザーにとって非常に大きなリスクでした。
  - 逆に秘密鍵が漏洩すると、アカウント内のすべての資産が盗まれる可能性があります。
  - このリスクは、大規模な資産を扱う機関投資家や企業にとって特に致命的であり、彼らがWeb3に参入する際の大きな足枷となっていました。
- 非柔軟な署名ロジック:
  - EOAの署名ロジックは、ECDSA（楕円曲線デジタル署名アルゴリズム）に固定されており、変更できません。
  - これにより、以下のような柔軟なセキュリティ対策や認証方法を導入できませんでした。
    - マルチシグ（複数人による承認）: 企業での資金管理など、複数の担当者による承認が必要なシナリオに対応できない。
    - ソーシャルリカバリー: 信頼できる第三者の助けを借りてアカウントを回復する仕組みがない。
    - 生体認証（指紋、顔認証など）: ウォレットの認証に、より使いやすく安全な生体認証を直接組み込むことができない。
    - 時間ロックや権限の細分化: 特定の期間や条件でのみトランザクションを許可したり、特定のDAppに限定的な権限を与えたりといった、きめ細やかなアクセス制御が不可能。
- プログラム可能性の欠如:
  - EOAは、スマートコントラクトではありません。そのため、プログラム可能なロジック（例えば、定期的な自動支払い、条件付きでの資金移動など）を直接組み込むことができませんでした。

## 2. Web3のユーザー体験（UX）の悪さ

これらのEOAの制約は、Web3アプリケーションのユーザー体験を著しく悪化させ、一般ユーザーがWeb3に参入する大きな障壁となっていました。

- ガス代の複雑さ:
  - すべてのトランザクションでガス代を支払う必要がありますが、ガス代は常に変動し、ユーザーにとって理解しづらいものでした。
  - DAppsを利用するたびにガス代が必要なため、ユーザーは常にETHなどのネイティブトークンをウォレットに持っておく必要があり、これはWeb2のサービスではありえない手間でした。
  - 特に新規ユーザーは、まずETHを購入してウォレットに送るというハードルに直面します。
- オンボーディングの難しさ:
  - シードフレーズの管理や、秘密鍵の保管といった、これまで一般ユーザーが経験したことのない概念を理解し、自己責任で管理する必要がありました。これはWeb2の「パスワードを忘れたら再設定」という体験とは大きくかけ離れていました。
- Web2とのギャップ:
  - Web2サービスでは当たり前の「パスワードを忘れた場合のリカバリー」「メールアドレスでのログイン」「クレジットカードでの支払い」といった体験が、Web3では（EOAの制約により）そのままでは実現できませんでした。これにより、Web2に慣れたユーザーがWeb3に移行する際の抵抗感が非常に大きかったのです。
  - 複数のトランザクションの煩雑さ:
  - DAppでの操作が複数のトランザクションに分かれている場合、ユーザーはそれぞれのトランザクションに署名し、ガス代を支払い、承認を待つ必要がありました。これは非常に手間がかかるものでした。

## AAによる解決への試み

これらの課題を解決するために、EOAの持つ固定的な構造を打破し、**「ユーザーのアカウント自体をカスタマイズ可能なスマートコントラクトにする」**という発想が生まれました。これがAccount Abstractionの核心です。

### AAは、以下のような可能性を提示します。

- 柔軟な認証・リカバリー: 秘密鍵に依存しない認証（マルチシグ、ソーシャルリカバリー、生体認証など）や、アカウントのリカバリーメカニズムを組み込む。
- ガス代の抽象化: ユーザーが直接ガス代を支払うのではなく、DAppや「スポンサー」が肩代わりしたり、ERC-20トークンでガス代を支払ったりできる仕組み。
- バッチ処理: 複数のトランザクションをまとめて1つのトランザクションとして実行し、ユーザーの署名回数を減らす。
- プログラム可能性: アカウント自体がスマートコントラクトであるため、自動支払いなど、より高度なロジックを組み込むことができる。

特にERC-4337は、プロトコルの中核部分（コンセンサスレイヤー）に大きな変更を加えることなく、これらの課題をユーザーランドで解決しようとするアプローチであり、その実現に向けて大きく期待されています

## 現状と普及状況

1. ERC-4337のリリースと実装:

   - ERC-4337は2023年3月にEthereumのプロトコルに大きな変更を加えることなく、ユーザーランドでAAを実現するための標準として実装されました。これは大きな一歩でした。
   - その後、一部のLayer 2（L2）ネットワーク（例: zkSync, Starknetなど）では、AAがよりネイティブな形でサポートされており、活発に利用が進んでいます。
   - Ethereumのメインネット上でも、BundlerやPaymasterといったインフラが徐々に整備され、AA対応のウォレットやDAppが登場しています。
  
2. 利用状況の兆し:
   - 月間100万を超えるAA関連のトランザクション数や、月間50万を超えるAAウォレットのアクティブユーザー数といった統計も報告され始めています。これは着実に利用が進んでいることを示唆しています。
   - しかし、これはWeb3全体のユーザー数やトランザクション数から見ると、まだ一部に過ぎません。
  
3. 主要なプロジェクトの取り組み:

   - AlchemyやCoinbaseなどの主要なWeb3インフラプロバイダーや、ArgentやSafe (旧Gnosis Safe) のようなスマートコントラクトウォレットのパイオニアがAAの導入と普及に積極的に取り組んでいます。
   - MetaMaskもSnapsを通じてAAの機能を拡張しようとしています。

### 普及に向けた課題

「普及」という観点では、まだいくつかの課題が残されています。

1. 互換性と移行の課題:

   - 既存のEOAウォレット（MetaMaskなど）とAAウォレットの間の互換性や、EOAからAAへのスムーズな移行パスがまだ確立されていません。多くのユーザーは既存のEOAに慣れており、新しいウォレットへの移行に抵抗があります。
   - 既存のDAppsがAAウォレットに完全に最適化されていない場合もあります。
2. ガス代の問題（特にL1）:

   - ERC-4337のトランザクションは、従来のEOAトランザクションと比較してガス代が高くなる傾向があります。これは、Entry Pointコントラクトでの追加のロジック実行によるものです。L2ではこのコストは大幅に削減されますが、Ethereum L1での利用はまだ高コストです。
3. 複雑性とセキュリティの認知:

   - 開発者側にとっては、スマートコントラクトウォレットの開発と監査はEOAウォレットよりも複雑でリソースを要します。
   - ユーザー側にとっては、「秘密鍵がないウォレット」や「リカバリーできるウォレット」といった概念は、既存のWeb3の常識とは異なるため、そのセキュリティモデルや信頼性について理解を深める必要があります。新たな攻撃ベクトルも考慮される必要があります。
4. インフラの成熟度:

   - BundlerやPaymasterといったAAに必要なインフラはまだ発展途上であり、より堅牢で分散化されたシステムが必要です。
5. ウォレットプロバイダーの戦略:

   - どのようなAAウォレットがユーザーに選ばれるか、その機能やUI/UXのベストプラクティスがまだ確立されていません。

## 今後の展望
- Pectraアップグレード: EthereumのPectraアップグレード（2025年予定）では、EIP-7702などのAA関連の提案が議論されており、これが実装されれば、AAのさらなるネイティブサポートが進む可能性があります。
- L2エコシステム: L2ネットワークはガス代が安く、より柔軟な設計が可能なため、AAの普及を牽引する主要なプラットフォームになると予想されます。
- 開発者の取り組み: ガス代を肩代わりするPaymasterの実装や、より直感的なオンボーディング（ソーシャルログインなど）を提供するDAppやウォレットが増えることで、ユーザー体験は劇的に向上するでしょう。

## Account Abstractionの普及と開発者の役割

開発者が様々な「アカウントコントラクトのバリエーション」を作成し、それをユーザーが選択して利用する、という形が普及の鍵になるでしょう。

- 現在のWeb3（EOA中心）:
  - スマートフォンを買ったけど、使えるアプリは「電話」と「メール」だけ、という状態。
  - 開発者がアプリを作っても、そのアプリを動かすためのOS（EOAウォレット）が標準化されていない。

- AAが普及した未来のWeb3:
  - 様々な機能を持つスマートフォン（Entry PointコントラクトやBundlerネットワーク）が普及する。
  - 開発者が「こんなウォレット機能が欲しい！」というニーズに応じた様々な**アカウントコントラクトのテンプレート（ファクトリーコントラクト）**を作成・提供する。
  - ユーザーは、App StoreやGoogle Playのように、自分のニーズに合ったアカウントコントラクトを選んでデプロイ（利用開始）する。

## アカウントコントラクトのバリエーション例
開発者が提供しうるアカウントコントラクトのバリエーション（テンプレート）は、例えば以下のようなものが考えられます。

- ソーシャルリカバリー型ウォレット:
  - 「秘密鍵をなくしても、信頼できる友人3人のうち2人の承認があればアカウントを復元できる」という機能を持つ。
- 多要素認証ウォレット:
  - 「送金時には、秘密鍵での署名に加えて、登録済みの別のデバイス（スマホの生体認証など）での承認も必要」というセキュリティ強化型。
- 自動化ウォレット:
  - 「毎月特定のアドレスに自動で一定額を送金する」「ガス代が特定の閾値を下回ったら自動で購入する」といったプログラマブルな機能を持つ。
- サブスクリプション支払いウォレット:
  - 「特定のサービスへの月額支払いを、自動的にガス代なしで処理できる」という体験に特化したもの。
- ゲーム特化型ウォレット:
  - 「ゲーム内で特定のアイテムを購入する際、パスワード入力なしでワンクリックで承認できる」など、ゲーム体験に最適化されたもの。
- 企業向けマルチシグウォレット:
  - 「経理部員2名、取締役1名の計3名全員の承認がなければ大口送金ができない」といった、企業統治に特化したもの。